{% extends 'base_frontoffice.html.twig' %}

{% trans_default_domain 'messages' %}

{% block title %}{{ 'student.dashboard_title'|trans }}{% endblock %}

{% block body %}

<section class="pt-0">
	<div class="container-fluid px-0">
		<div class="card bg-blue h-100px h-md-180px rounded-0" style="background:url('{{ asset('assets/images/pattern/04.png') }}') no-repeat center center; background-size:cover;"></div>
	</div>
	<div class="container mt-n4">
		<div class="row">
			<div class="col-12">
				<div class="card bg-transparent card-body pb-0 px-0 mt-2 mt-sm-0">
					<div class="row d-sm-flex justify-content-sm-between mt-2 mt-md-0">
						<div class="col-auto">
							<div class="avatar avatar-xxl position-relative mt-n3">
								<img class="avatar-img rounded-circle border border-white border-3 shadow" src="{{ asset('assets/images/avatar/09.jpg') }}" alt="Student avatar">
								<span class="badge text-bg-success rounded-pill position-absolute top-50 start-100 translate-middle mt-4 mt-md-5 ms-n3 px-md-3">{{ 'student.pro'|trans }}</span>
							</div>
						</div>
						<div class="col d-sm-flex justify-content-between align-items-center">
							<div>
								<h1 class="my-1 fs-4">{{ 'student.dashboard_title'|trans }}</h1>
								<ul class="list-inline mb-0">
									<li class="list-inline-item me-3 mb-1 mb-sm-0">
										<span class="h6">{{ completedLessonsTotal * 5 }}</span>
										<span class="text-body fw-light">{{ 'student.points'|trans }}</span>
									</li>
									<li class="list-inline-item me-3 mb-1 mb-sm-0">
										<span class="h6">{{ completedCourses }}</span>
										<span class="text-body fw-light">{{ 'student.completed_courses'|trans }}</span>
									</li>
									<li class="list-inline-item me-3 mb-1 mb-sm-0">
										<span class="h6">{{ completedLessonsTotal }}</span>
										<span class="text-body fw-light">{{ 'student.completed_lessons'|trans }}</span>
									</li>
								</ul>
							</div>
							<div class="mt-2 mt-sm-0">
								<a href="{{ path('front_courses') }}" class="btn btn-outline-primary mb-0">{{ 'student.view_all_courses'|trans }}</a>
							</div>
						</div>
					</div>
				</div>

				<hr class="d-xl-none">
				<div class="col-12 col-xl-3 d-flex justify-content-between align-items-center">
					<a class="h6 mb-0 fw-bold d-xl-none" href="#">{{ 'student.menu'|trans }}</a>
					<button class="btn btn-primary d-xl-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" aria-controls="offcanvasSidebar">
						<i class="fas fa-sliders-h"></i>
					</button>
				</div>
			</div>
		</div>
	</div>
</section>

<section class="pt-0 pb-5">
	<div class="container">
		<div class="row">
			<div class="col-xl-3">
				<div class="offcanvas-xl offcanvas-end" tabindex="-1" id="offcanvasSidebar">
					<div class="offcanvas-header bg-light">
						<h5 class="offcanvas-title">{{ 'student.my_profile'|trans }}</h5>
						<button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#offcanvasSidebar" aria-label="Close"></button>
					</div>
					<div class="offcanvas-body p-3 p-xl-0">
						<div class="bg-dark border rounded-3 p-3 w-100">
							<div class="list-group list-group-dark list-group-borderless collapse-list">
								<a class="list-group-item active" href="{{ path('front_student_dashboard') }}"><i class="bi bi-ui-checks-grid fa-fw me-2"></i>{{ 'nav.dashboard'|trans }}</a>
								<a class="list-group-item" href="{{ path('front_courses') }}"><i class="bi bi-basket fa-fw me-2"></i>{{ 'student.my_courses'|trans }}</a>
								<a class="list-group-item" href="#"><i class="bi bi-card-checklist fa-fw me-2"></i>{{ 'student.my_subscriptions'|trans }}</a>
								<a class="list-group-item" href="#"><i class="bi bi-credit-card-2-front fa-fw me-2"></i>{{ 'student.payment_info'|trans }}</a>
								<a class="list-group-item" href="#"><i class="bi bi-cart-check fa-fw me-2"></i>{{ 'student.wishlist'|trans }}</a>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="col-xl-9">
				<div class="row mb-4">
					<div class="col-sm-6 col-lg-4 mb-3 mb-lg-0">
						<div class="d-flex justify-content-center align-items-center p-4 bg-orange bg-opacity-15 rounded-3">
							<span class="display-6 lh-1 text-orange mb-0"><i class="fas fa-tv fa-fw"></i></span>
							<div class="ms-4">
								<h5 class="purecounter mb-0 fw-bold" data-purecounter-start="0" data-purecounter-end="{{ totalCourses }}" data-purecounter-delay="200">{{ totalCourses }}</h5>
								<p class="mb-0 h6 fw-light">{{ 'student.total_courses'|trans }}</p>
							</div>
						</div>
					</div>
					<div class="col-sm-6 col-lg-4 mb-3 mb-lg-0">
						<div class="d-flex justify-content-center align-items-center p-4 bg-purple bg-opacity-15 rounded-3">
							<span class="display-6 lh-1 text-purple mb-0"><i class="fas fa-clipboard-check fa-fw"></i></span>
							<div class="ms-4">
								<h5 class="purecounter mb-0 fw-bold" data-purecounter-start="0" data-purecounter-end="{{ completedLessonsTotal }}" data-purecounter-delay="200">{{ completedLessonsTotal }}</h5>
								<p class="mb-0 h6 fw-light">{{ 'student.completed_lessons'|trans }}</p>
							</div>
						</div>
					</div>
					<div class="col-sm-6 col-lg-4 mb-3 mb-lg-0">
						<div class="d-flex justify-content-center align-items-center p-4 bg-success bg-opacity-10 rounded-3">
							<span class="display-6 lh-1 text-success mb-0"><i class="fas fa-medal fa-fw"></i></span>
							<div class="ms-4">
								<h5 class="purecounter mb-0 fw-bold" data-purecounter-start="0" data-purecounter-end="{{ completedCourses }}" data-purecounter-delay="300">{{ completedCourses }}</h5>
								<p class="mb-0 h6 fw-light">{{ 'student.completed_courses'|trans }}</p>
							</div>
						</div>
					</div>
				</div>

				<div class="row g-4 mb-4">
					<div class="col-lg-5">
						<div class="card border rounded-3 h-100">
							<div class="card-header bg-transparent border-bottom">
								<h5 class="mb-0">{{ 'student.chart.completion_title'|trans }}</h5>
							</div>
							<div class="card-body">
								{% if completionChart %}
									{{ render_chart(completionChart) }}
								{% else %}
									<p class="text-muted mb-0">{{ 'student.chart.no_data'|trans }}</p>
								{% endif %}
							</div>
						</div>
					</div>
					<div class="col-lg-7">
						<div class="card border rounded-3 h-100">
							<div class="card-header bg-transparent border-bottom">
								<h5 class="mb-0">{{ 'student.chart.progress_title'|trans }}</h5>
							</div>
							<div class="card-body">
								{% if progressByCourseChart %}
									{{ render_chart(progressByCourseChart) }}
								{% else %}
									<p class="text-muted mb-0">{{ 'student.chart.no_data'|trans }}</p>
								{% endif %}
							</div>
						</div>
					</div>
				</div>

				<div class="card bg-transparent border rounded-3">
					<div class="card-header bg-transparent border-bottom">
						<h3 class="mb-0">{{ 'student.my_courses_list'|trans }}</h3>
					</div>
					<div class="card-body">
						<div class="row g-3 align-items-center justify-content-between mb-4">
							<div class="col-md-8">
								<form class="rounded position-relative" onsubmit="return false;">
									<input class="form-control pe-5 bg-transparent" type="search" placeholder="{{ 'student.search_my_list'|trans }}" aria-label="{{ 'common.search'|trans }}">
									<button class="bg-transparent p-2 position-absolute top-50 end-0 translate-middle-y border-0 text-primary-hover text-reset" type="submit">
										<i class="fas fa-search fs-6"></i>
									</button>
								</form>
							</div>
							<div class="col-md-4 text-md-end">
								<a href="{{ path('front_courses') }}" class="btn btn-sm btn-primary">{{ 'student.add_more_courses'|trans }}</a>
							</div>
						</div>

						<div class="table-responsive border-0">
							<table class="table table-dark-gray align-middle p-4 mb-0 table-hover">
								<thead>
									<tr>
										<th scope="col" class="border-0 rounded-start">{{ 'student.course_title'|trans }}</th>
										<th scope="col" class="border-0">{{ 'student.total_lectures'|trans }}</th>
										<th scope="col" class="border-0">{{ 'student.completed_lecture'|trans }}</th>
										<th scope="col" class="border-0 rounded-end">{{ 'student.action'|trans }}</th>
									</tr>
								</thead>
								<tbody>
									{% for item in studentCourses %}
										{% set c = item.course %}
										<tr>
											<td>
												<div class="d-flex align-items-center">
													<div class="w-100px">
														<img src="{{ c.image ? asset('uploads/images/cours/' ~ c.image) : asset('assets/images/courses/4by3/01.jpg') }}" class="rounded" alt="{{ c.titre }}">
													</div>
													<div class="mb-0 ms-2">
														<h6 class="mb-1">{{ c.titre }}</h6>
														<h6 class="mb-0 text-end">{{ item.progress }}%</h6>
														<div class="progress progress-sm bg-primary bg-opacity-10">
															<div class="progress-bar bg-primary" role="progressbar" style="width: {{ item.progress }}%" aria-valuenow="{{ item.progress }}" aria-valuemin="0" aria-valuemax="100"></div>
														</div>
													</div>
												</div>
											</td>
											<td>{{ item.totalLecons }}</td>
											<td>{{ item.completedLessons }}</td>
											<td class="text-nowrap">
												{% if item.progress < 100 %}
													<form method="post" action="{{ path('front_student_course_continue', {'id': c.id}) }}" class="d-inline">
														<input type="hidden" name="_token" value="{{ csrf_token('student_course_continue_' ~ c.id) }}">
														<button type="submit" class="btn btn-sm btn-primary-soft me-1 mb-1 mb-md-0"><i class="bi bi-play-circle me-1"></i>{{ 'common.continue'|trans }}</button>
													</form>
												{% else %}
													<span class="btn btn-sm btn-success me-1 mb-1 mb-md-0 disabled"><i class="bi bi-check me-1"></i>{{ 'common.completed'|trans }}</span>
												{% endif %}
												<form method="post" action="{{ path('front_student_course_toggle', {'id': c.id}) }}" class="d-inline">
													<input type="hidden" name="_token" value="{{ csrf_token('student_course_toggle_' ~ c.id) }}">
													<button type="submit" class="btn btn-sm btn-light mb-1 mb-md-0"><i class="bi bi-trash me-1"></i>{{ 'student.remove'|trans }}</button>
												</form>
											</td>
										</tr>
									{% else %}
										<tr>
											<td colspan="4" class="text-center py-4">
												<p class="mb-3">{{ 'student.no_courses'|trans }}</p>
												<a href="{{ path('front_courses') }}" class="btn btn-primary btn-sm">{{ 'student.add_courses'|trans }}</a>
											</td>
										</tr>
									{% endfor %}
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

{% endblock %}
