{% extends 'base_auth.html.twig' %}

{% block title %}Reset Password - Eduport{% endblock %}

{% block body %}
<section class="p-0 d-flex align-items-center position-relative overflow-hidden">
	
	<div class="container-fluid">
		<div class="row">
			<!-- left -->
			<div class="col-12 col-lg-6 d-md-flex align-items-center justify-content-center bg-primary bg-opacity-10 vh-lg-100">
				<div class="p-3 p-lg-5">
					<!-- Title -->
					<div class="text-center">
						<h2 class="fw-bold">New Password</h2>
						<p class="mb-0 h6 fw-light">Create a strong password for your account</p>
					</div>
					<!-- SVG Image -->
					<img src="assets/images/element/02.svg" class="mt-5" alt="">
					<!-- Info -->
					<div class="d-sm-flex mt-5 align-items-center justify-content-center">
						<!-- Avatar group -->
						<ul class="avatar-group mb-2 mb-sm-0">
							<li class="avatar avatar-sm">
								<img class="avatar-img rounded-circle" src="assets/images/avatar/01.jpg" alt="avatar">
							</li>
							<li class="avatar avatar-sm">
								<img class="avatar-img rounded-circle" src="assets/images/avatar/02.jpg" alt="avatar">
							</li>
							<li class="avatar avatar-sm">
								<img class="avatar-img rounded-circle" src="assets/images/avatar/03.jpg" alt="avatar">
							</li>
							<li class="avatar avatar-sm">
								<img class="avatar-img rounded-circle" src="assets/images/avatar/04.jpg" alt="avatar">
							</li>
						</ul>
						<!-- Content -->
						<p class="mb-0 h6 fw-light ms-0 ms-sm-3">Your password has been verified</p>
					</div>
				</div>
			</div>

			<!-- Right -->
			<div class="col-12 col-lg-6 m-auto">
				<div class="row my-5">
					<div class="col-sm-10 col-xl-8 m-auto">
						<!-- Title -->
						<span class="mb-0 fs-1">ðŸ”‘</span>
						<h1 class="fs-2">Create New Password</h1>
						<p class="lead mb-4">For account <strong>{{ email }}</strong></p>

						{% if error %}
							<div class="alert alert-danger alert-dismissible fade show" role="alert">
								{{ error }}
								<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
							</div>
						{% endif %}

						<form method="POST" action="{{ path('app_reset_password') }}" id="resetForm">
							<!-- New Password -->
							<div class="mb-4">
								<label for="password" class="form-label">New Password *</label>
								<div class="input-group input-group-lg">
									<span class="input-group-text bg-light rounded-start border-0 text-secondary px-3"><i class="fas fa-lock"></i></span>
									<input type="password" id="password" name="password" class="form-control border-0 bg-light rounded-end ps-1" placeholder="Password" required>
									<button class="btn btn-light border-0 rounded-end" type="button" id="togglePassword">
										<i class="bi bi-eye-fill"></i>
									</button>
								</div>
								<div id="passwordHelpBlock" class="form-text">
									Password must be at least 8 characters long
								</div>
							</div>

							<!-- Confirm Password -->
							<div class="mb-4">
								<label for="confirm_password" class="form-label">Confirm Password *</label>
								<div class="input-group input-group-lg">
									<span class="input-group-text bg-light rounded-start border-0 text-secondary px-3"><i class="fas fa-lock"></i></span>
									<input type="password" id="confirm_password" name="confirm_password" class="form-control border-0 bg-light rounded-end ps-1" placeholder="Confirm Password" required>
									<button class="btn btn-light border-0 rounded-end" type="button" id="toggleConfirmPassword">
										<i class="bi bi-eye-fill"></i>
									</button>
								</div>
								<div id="matchHelpBlock" class="form-text">
									Both passwords must match
								</div>
							</div>

							<!-- Password Match Indicator -->
							<div class="mb-4">
								<div id="passwordMatch" class="alert alert-info d-none" role="alert">
									<i class="bi bi-check-circle me-2"></i>Passwords match!
								</div>
								<div id="passwordMismatch" class="alert alert-warning d-none" role="alert">
									<i class="bi bi-exclamation-circle me-2"></i>Passwords do not match
								</div>
							</div>

							<!-- Submit button -->
							<div class="d-grid">
								<button class="btn btn-primary mb-0" type="submit">Reset Password</button>
							</div>
						</form>

						<!-- Back to login -->
						<p class="mb-0 mt-4 text-center">
							<a href="{{ path('app_login') }}">Back to Sign in</a>
						</p>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<script>
	document.addEventListener('DOMContentLoaded', function() {
		const passwordInput = document.getElementById('password');
		const confirmPasswordInput = document.getElementById('confirm_password');
		const togglePassword = document.getElementById('togglePassword');
		const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');
		const passwordMatch = document.getElementById('passwordMatch');
		const passwordMismatch = document.getElementById('passwordMismatch');

		// Toggle password visibility
		togglePassword.addEventListener('click', function() {
			const type = passwordInput.type === 'password' ? 'text' : 'password';
			passwordInput.type = type;
			this.querySelector('i').classList.toggle('bi-eye-fill');
			this.querySelector('i').classList.toggle('bi-eye-slash-fill');
		});

		toggleConfirmPassword.addEventListener('click', function() {
			const type = confirmPasswordInput.type === 'password' ? 'text' : 'password';
			confirmPasswordInput.type = type;
			this.querySelector('i').classList.toggle('bi-eye-fill');
			this.querySelector('i').classList.toggle('bi-eye-slash-fill');
		});

		// Check password match in real-time
		function checkPasswordMatch() {
			if (passwordInput.value && confirmPasswordInput.value) {
				if (passwordInput.value === confirmPasswordInput.value) {
					passwordMatch.classList.remove('d-none');
					passwordMismatch.classList.add('d-none');
				} else {
					passwordMatch.classList.add('d-none');
					passwordMismatch.classList.remove('d-none');
				}
			} else {
				passwordMatch.classList.add('d-none');
				passwordMismatch.classList.add('d-none');
			}
		}

		passwordInput.addEventListener('input', checkPasswordMatch);
		confirmPasswordInput.addEventListener('input', checkPasswordMatch);
	});
</script>
{% endblock %}
